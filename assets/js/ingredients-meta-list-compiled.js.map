{"version":3,"sources":["ingredients-meta-list.js"],"names":[],"mappings":"+YAAA,CAAC,CAAC,UAAY,CA2FV,QAAS,CAAA,CAAT,EAAgB,CACZ,GAAI,CACA,CAAkB,CAAG,IAAI,CAAC,KAAL,CAAW,CAAU,CAAC,GAAX,EAAX,CACxB,CAAC,MAAM,CAAN,CAAS,CACJ,CADI,EAEH,OAAO,CAAC,KAAR,CAAc,6BAAd,CAA6C,CAAU,CAAC,GAAX,EAA7C,CAA8D,4BAA9D,CAA4F,CAA5F,CAFG,CAIP,CAAkB,CAAG,EACxB,CACD,CAAO,CAAG,GAAI,CAAA,CAAJ,CAAY,CAAZ,CATE,CAWZ,CAAM,CAAC,CAAD,CAXM,CAYZ,CAAsB,EAZV,CAcZ,CAAa,CAAC,QAAd,CAAuB,CACnB,MAAM,CAAE,CADW,CAEnB,KAAK,CAAE,CAFY,CAGnB,IAAI,CAAE,CAHa,CAInB,MAAM,CAAE,UAJW,CAAvB,CAdY,CAqBZ,QAAQ,CAAC,cAAT,CAAwB,eAAxB,EAAyC,gBAAzC,CAA0D,OAA1D,CAAmE,CAAnE,CACH,CAED,QAAS,CAAA,CAAT,CAAgB,CAAhB,CAA6B,CACzB,CAAa,CAAC,KAAd,EADyB,CAEzB,CAAW,CAAC,OAAZ,CAAoB,SAAC,CAAD,CAAgB,CAChC,CAAa,CAAC,MAAd,CAAqB,CAAqB,CAAC,CAAD,CAA1C,CACH,CAFD,CAGH,CAED,QAAS,CAAA,CAAT,CAAkC,CAAlC,CAAqC,CACjC,CAAC,CAAC,cAAF,EADiC,CAEjC,GAAM,CAAA,CAAa,CAAG,CAClB,KAAK,CAAE,CAAS,CAAC,CAAW,CAAC,GAAZ,EAAD,CADE,CAElB,MAAM,CAAE,CAAS,CAAC,CAAY,CAAC,GAAb,EAAD,CAFC,CAGlB,IAAI,CAAE,CAAS,CAAC,CAAU,CAAC,GAAX,EAAD,CAHG,CAAtB,CAMA;AADA,CAAG,CAAC,CAAD,CAP8B,CASjC,CAAM,CAAC,OAAP,CAAe,SAAC,CAAD,QAAW,CAAA,CAAK,CAAC,GAAN,CAAU,EAAV,CAAX,CAAf,CATiC,CAUjC,CAAW,CAAC,KAAZ,EACH,CAED,QAAS,CAAA,CAAT,EAAkC,CAK9B;AAJA,CAAa,CAAC,KAAd,CAAoB,CAApB,CAD8B,CAE9B,CAAK,CAAC,KAAN,CAAY,SAAA,CAAC,QAAI,CAAA,CAAO,CAAC,IAAR,CAAa,CAAb,CAAJ,CAAb,CAF8B,CAG9B,CAAK,CAAC,KAAN,CAAY,SAAA,CAAC,QAAI,CAAA,CAAO,CAAC,IAAR,CAAa,CAAb,CAAJ,CAAb,CAH8B,CAM9B,CAAC,CAAC,iFAAD,CAAD,CAAqF,EAArF,CAAwF,OAAxF,CAAiG,SAAU,CAAV,CAAa,CACxF,EAAd,GAAA,CAAC,CAAC,OADoG,EAEtG,CAAwB,CAAC,CAAD,CAE/B,CAJD,CAN8B,CAY9B,EAAE,CAAC,IAAH,CAAQ,SAAR,CAAkB,UAAY,IACpB,CAAA,CAAQ,CAAG,EAAE,CAAC,IAAH,CAAQ,MAAR,CAAe,aAAf,EAA8B,YAA9B,EADS,CAEpB,CAAY,CAAG,EAAE,CAAC,IAAH,CAAQ,MAAR,CAAe,aAAf,EAA8B,gBAA9B,EAFK,CAItB,CAAQ,EAAI,CAAC,CAJS,EAKtB,CAAW,CAAC,MAAZ,IAEP,CAPD,CAQH,CAED,QAAS,CAAA,CAAT,CAA+B,CAA/B,CAA2C,CACvC,mHAE0C,CAAU,CAAC,KAAX,CAAmB,CAAS,CAAC,CAAU,CAAC,KAAZ,CAA5B,CAAiD,EAF3F,wEAG2C,CAAU,CAAC,MAAX,CAAoB,CAAU,CAAC,MAA/B,CAAwC,EAHnF,sEAIyC,CAAU,CAAC,IAAX,CAAkB,CAAU,CAAC,IAA7B,CAAoC,EAJ7E,mIAOH,CAED,QAAS,CAAA,CAAT,EAAyB,CACrB,GAAM,CAAA,CAAU,CAAG,CAAY,EAA/B,CAEA,MADA,CAAA,CAAK,CAAC,CAAD,CACL,CAAO,CACV,CAED,QAAS,CAAA,CAAT,EAAqB,CACjB,GAAM,CAAA,CAAU,CAAG,CAAa,EAAhC,CACA,CAAO,CAAC,IAAR,CAAa,CAAb,CACH,CAED,QAAS,CAAA,CAAT,EAAwB,CACpB,GAAI,CAAA,CAAO,CAAG,QAAQ,CAAC,cAAT,CAAwB,eAAxB,CAAd,CACA,MAAO,CAAA,KAAK,CACP,IADE,CACG,CAAO,CAAC,UADX,EAEF,MAFE,CAEK,SAAA,CAAI,QAAI,CAAA,CAAI,CAAC,QAAL,GAAkB,IAAI,CAAC,SAA3B,CAFT,EAGF,GAHE,CAGE,SAAA,CAAI,QAAI,CAAA,CAAS,CAAC,CAAD,CAAb,CAHN,CAIV,CAED,QAAS,CAAA,CAAT,CAAmB,CAAnB,CAAyB,CACrB;AACA,MAAO,CAAA,KAAK,CACP,IADE,CACG,CAAI,CAAC,UADR,EAEF,MAFE,CAEK,SAAA,CAAI,QAAI,CAAA,CAAI,CAAC,QAAL,GAAkB,IAAI,CAAC,SAAvB,EAAoE,MAAhC,GAAA,CAAI,CAAC,QAAL,CAAc,WAAd,EAAxC,CAFT,EAGF,GAHE,CAGE,SAAA,CAAI,QAAI,CAAA,CAAS,CAAC,CAAD,CAAb,CAHN,EAIF,MAJE,CAIK,SAAC,CAAD,CAAwB,CAAxB,CAAiC,CACrC,GAAI,CAAJ,CAEI,MADA,CAAA,CAAqB,CAAC,CAAI,CAAC,UAAN,CAArB,CAAyC,CAAI,CAAC,IAC9C,CAAO,CAEd,CATE,CASA,EATA,CAUV,CAED,QAAS,CAAA,CAAT,CAAmB,CAAnB,CAAyB,CACrB,GAAI,CAAC,CAAI,CAAC,SAAN,EAA6C,CAA1B,GAAA,CAAI,CAAC,SAAL,CAAe,MAAtC,CACI,0CAAoC,CAApC,qDAEJ,GAAM,CAAA,CAAoB,CAAG,CAAI,CAAC,SAAL,CAAe,CAAf,EAAkB,KAAlB,CAAwB,GAAxB,CAA7B,CACA,GAAoC,CAAhC,GAAA,CAAoB,CAAC,MAArB,EAAqC,CAAC,CAAI,CAAC,SAAL,CAAe,CAAf,EAAkB,UAAlB,CAA6B,kBAA7B,CAA1C,CACI,0CAAoC,CAApC,qDAEJ,GAAM,CAAA,CAAU,CAAG,CAAI,CAAC,SAAL,CAAe,CAAf,EAAkB,KAAlB,CAAwB,GAAxB,EAA6B,CAA7B,CAAnB,CARqB,MASjB,CAAA,CAAW,CAAC,QAAZ,CAAqB,CAArB,CATiB,CAUV,CAAC,UAAU,CAAE,CAAb,CAAyB,IAAI,CAAE,CAAI,CAAC,SAApC,CAVU,CAYd,IACV,CAED,QAAS,CAAA,CAAT,CAAe,CAAf,CAA2B,CACvB,GAAM,CAAA,CAAQ,CAAG,IAAI,CAAC,SAAL,CAAe,CAAf,CAAjB,CAOA,MANG,CAAA,CAMH,GALI,OAAO,CAAC,GAAR,CAAY,WAAZ,CAAyB,CAAzB,CAKJ,CAJI,OAAO,CAAC,KAAR,CAAc,CAAd,CAIJ,EAFA,CAAU,CAAC,GAAX,CAAe,CAAf,CAEA,CADA,CAAI,CAAC,CAAD,CACJ,CAAO,CACV,CAED,QAAS,CAAA,CAAT,CAAc,CAAd,CAAwB,CACpB,CAAW,CAAC,MAAZ,IADoB,CAEpB,GAAM,CAAA,CAAM,CAAG,EAAE,CAAC,IAAH,CAAQ,MAAR,CAAe,aAAf,EAA8B,gBAA9B,EAAf,CACA,KAAK,WAAI,CAAJ,kCAAoC,CAApC,iBAA0D,CACvD,MAAM,CAAE,KAD+C,CAEvD,IAAI,CAAE,CAFiD,CAGvD,OAAO,CAAE,CACL,eAAgB,kBADX,CAEL,aAAc,CAFT,CAH8C,CAA1D,CAAL,CAOG,IAPH,CAOQ,SAAA,CAAQ,CAAI,CACb,CADa,EACG,OAAO,CAAC,GAAR,CAAY,CAAZ,CADH,CAEhB,CAAW,CAAC,MAAZ,IACH,CAVD,CAWH,CAED,QAAS,CAAA,CAAT,CAAa,CAAb,CAAyB,CACrB,CAAa,CACR,MADL,CACY,CAAqB,CAAC,CAAD,CADjC,EAEK,QAFL,CAEc,SAFd,CADqB,CAKrB,CAAS,EACZ,CAED,QAAS,CAAA,CAAT,CAAwB,CAAxB,CAA2B,EAEkB,KAApC,GAAA,CAAC,CAAC,MAAF,CAAS,QAAT,CAAkB,WAAlB,IAA6C,CAAC,CAAC,MAAF,CAAS,SAAT,CAAmB,QAAnB,CAA4B,oBAA5B,CAA9C,EACuC,MAApC,GAAA,CAAC,CAAC,MAAF,CAAS,QAAT,CAAkB,WAAlB,IAA8C,CAAC,CAAC,MAAF,CAAS,SAAT,CAAmB,QAAnB,CAA4B,mBAA5B,CAH9B,IAInB,CAAC,CAAC,MAAF,CAAS,OAAT,CAAiB,IAAjB,EAAuB,MAAvB,EAJmB,CAKnB,CAAS,EALU,CAO1B,CAED,QAAS,CAAA,CAAT,CAAiC,CAAjC,CAAwC,CAAxC,CAA4C,CACxC,CAAE,CAAC,IAAH,CAAQ,WAAR,CAAoB,cAApB,CACH,CAED,QAAS,CAAA,CAAT,CAA8B,CAA9B,CAAqC,CAArC,CAAyC,CACrC,CAAE,CAAC,IAAH,CAAQ,QAAR,CAAiB,cAAjB,CACH,CAED,QAAS,CAAA,CAAT,CAAmB,CAAnB,CAAyB,CACrB,GAAM,CAAA,CAAG,CAAG,GAAI,CAAA,SAAJ,GAAgB,eAAhB,CAAgC,CAAhC,CAAsC,WAAtC,CAAZ,CACA,MAAO,CAAA,CAAG,CAAC,IAAJ,CAAS,WAAT,EAAwB,EAClC,CA9QS,GAYN,CAAA,CAZM,CAYG,CAZH,CACJ,CAAa,CAAG,CAAC,CAAC,gBAAD,CADb,CAEJ,CAAU,CAAG,CAAC,CAAC,yBAAD,CAFV,CAGJ,CAAa,CAAG,CAAC,CAAC,kBAAD,CAHb,CAIJ,CAAW,CAAG,CAAC,CAAC,2BAAD,CAJX,CAKJ,CAAY,CAAG,CAAC,CAAC,4BAAD,CALZ,CAMJ,CAAU,CAAG,CAAC,CAAC,0BAAD,CANV,CAOJ,CAAW,CAAG,CAAC,CAAC,oCAAD,CAPX,CAQJ,CAAK,CAAG,CAAC,CAAC,wBAAD,CARL,CASJ,CAAK,CAAG,CAAC,CAAC,wBAAD,CATL,CAUJ,CAAM,CAAG,CAAC,CAAD,CAAc,CAAd,CAA4B,CAA5B,CAVL,CAWJ,CAAW,CAAG,CAAC,OAAD,CAAU,QAAV,CAAoB,MAApB,CAXV,CAcJ,CAAO,CAAG,2BAA2B,KAdjC,CAeJ,CAAK,CAAG,2BAA2B,MAf/B,CAgBJ,CAAc,CAAG,2BAA2B,eAhBxC,CAuBJ,CAvBI,yBAyBN,WAAY,CAAZ,CAAgC,yBAC5B,KAAK,OAAL,CAAe,EADa,CAE5B,KAAK,OAAL,CAAa,IAAb,CAAkB,CAAlB,CAF4B,CAG5B,KAAK,OAAL,CAAe,CAHa,CAI5B,CAAK,CAAC,GAAN,CAAU,OAAV,CAAmB,SAAnB,CAJ4B,CAK5B,CAAK,CAAC,GAAN,CAAU,OAAV,CAAmB,SAAnB,CACH,CA/BK,oEAiCO,CACT,MAAO,MAAK,OAAL,GAAiB,KAAK,OAAL,CAAa,MAAb,CAAsB,CACjD,CAnCK,6CAqCM,CACR,MAAwB,EAAjB,QAAK,OACf,CAvCK,kCAyCD,CAzCC,CAyCY,CACT,KAAK,UAAL,EADS,GAEV,KAAK,OAAL,CAAe,KAAK,OAAL,CAAa,KAAb,CAAmB,CAAnB,CAAsB,KAAK,OAA3B,CAFL,EAId,KAAK,OAAL,CAAa,IAAb,CAAkB,CAAlB,CAJc,CAKd,KAAK,OAAL,CAAe,KAAK,OAAL,CAAa,MAAb,CAAsB,CALvB,CAMd,KAAK,qBAAL,EACH,CAhDK,kCAkDD,CAlDC,CAkDE,CACJ,CAAC,CAAC,cAAF,EADI,CAEC,KAAK,SAAL,EAFD,GAGA,KAAK,OAAL,EAAgB,CAHhB,CAIA,KAAK,WAAL,EAJA,EAMJ,KAAK,qBAAL,EACH,CAzDK,kCA2DD,CA3DC,CA2DE,CACJ,CAAC,CAAC,cAAF,EADI,CAEC,KAAK,UAAL,EAFD,GAGA,KAAK,OAAL,EAAgB,CAHhB,CAIA,KAAK,WAAL,EAJA,EAMJ,KAAK,qBAAL,EACH,CAlEK,qEAoEkB,CAEhB,KAAK,UAAL,EAFgB,CAGhB,CAAK,CAAC,GAAN,CAAU,OAAV,CAAmB,SAAnB,CAHgB,CAKhB,CAAK,CAAC,GAAN,CAAU,OAAV,CAAmB,OAAnB,CALgB,CAQhB,KAAK,SAAL,EARgB,CAShB,CAAK,CAAC,GAAN,CAAU,OAAV,CAAmB,SAAnB,CATgB,CAWhB,CAAK,CAAC,GAAN,CAAU,OAAV,CAAmB,OAAnB,CAEP,CAjFK,iDAmFQ,CACV,CAAM,CAAC,KAAK,OAAL,CAAa,KAAK,OAAlB,CAAD,CADI,CAEV,CAAa,EAChB,CAtFK,SAyFV,CAAI,EAsLP,CA/QA,C","file":"ingredients-meta-list-compiled.js","sourcesContent":["$(function () {\r\n    const $sortableList = $(\"#sortable_list\");\r\n    const $jsonStore = $(\"#cbtb_ingredients_field\");\r\n    const $submitButton = $(\"#list_item_adder\");\r\n    const $titleInput = $(\"#add-new-ingredient-title\");\r\n    const $amountInput = $(\"#add-new-ingredient-amount\");\r\n    const $unitInput = $(\"#add-new-ingredient-unit\");\r\n    const $saveNotice = $(\"#cbtb-ingredients-list-save-notice\");\r\n    const $undo = $(\"#cbtb-ingredients-undo\");\r\n    const $redo = $(\"#cbtb-ingredients-redo\");\r\n    const inputs = [$titleInput, $amountInput, $unitInput];\r\n    const identifiers = [\"title\", \"amount\", \"unit\"];\r\n    let history, initialIngredients; // initialized in init();\r\n    // generated and passed down by wp_localize_script in class-recipe-block-editor.php\r\n    const apiRoot = cbtbIngredientsRestSettings[\"root\"];\r\n    const nonce = cbtbIngredientsRestSettings[\"nonce\"];\r\n    const loggingEnabled = cbtbIngredientsRestSettings[\"loggingEnabled\"];\r\n\r\n    /*\r\n    * Manages this meta-boxes state history by combining an array\r\n    * of remembered states with a pointer to the currently rendered\r\n    * state\r\n    */\r\n    class History {\r\n\r\n        constructor(initialIngredients) {\r\n            this.history = [];\r\n            this.history.push(initialIngredients);\r\n            this.pointer = 0;\r\n            $redo.css('color', '#bcbcbc');\r\n            $undo.css('color', '#bcbcbc');\r\n        }\r\n\r\n        _atPresent() {\r\n            return this.pointer === this.history.length - 1;\r\n        }\r\n\r\n        _atOldest() {\r\n            return this.pointer === 0;\r\n        }\r\n\r\n        push(ingredients) {\r\n            if (!this._atPresent()) {\r\n                this.history = this.history.slice(0, this.pointer)\r\n            }\r\n            this.history.push(ingredients);\r\n            this.pointer = this.history.length - 1;\r\n            this._decideOnButtonStates();\r\n        }\r\n\r\n        undo(e) {\r\n            e.preventDefault();\r\n            if (!this._atOldest()) {\r\n                this.pointer -= 1;\r\n                this.makeHistory()\r\n            }\r\n            this._decideOnButtonStates();\r\n        }\r\n\r\n        redo(e) {\r\n            e.preventDefault();\r\n            if (!this._atPresent()) {\r\n                this.pointer += 1;\r\n                this.makeHistory()\r\n            }\r\n            this._decideOnButtonStates();\r\n        }\r\n\r\n        _decideOnButtonStates() {\r\n            // cant go forward\r\n            if (this._atPresent()) {\r\n                $redo.css('color', '#bcbcbc');\r\n            } else {\r\n                $redo.css('color', 'black');\r\n            }\r\n            // cant go backwards\r\n            if (this._atOldest()) {\r\n                $undo.css('color', '#bcbcbc');\r\n            } else {\r\n                $undo.css('color', 'black')\r\n            }\r\n        }\r\n\r\n        makeHistory() {\r\n            render(this.history[this.pointer]);\r\n            parseAndStore();\r\n        }\r\n    }\r\n\r\n    init();\r\n\r\n    function init() {\r\n        try {\r\n            initialIngredients = JSON.parse($jsonStore.val());\r\n        } catch(e) {\r\n            if(loggingEnabled) {\r\n                console.error(\"Couldn't parse ingredients:\", $jsonStore.val(),\"Falling back to empty list\", e);\r\n            }\r\n            initialIngredients = [];\r\n        }\r\n        history = new History(initialIngredients);\r\n\r\n        render(initialIngredients);\r\n        registerEventListeners();\r\n\r\n        $sortableList.sortable({\r\n            update: saveState,\r\n            start: styleItemBeingSorted,\r\n            stop: removeBeingSortedStyles,\r\n            cursor: 'grabbing'\r\n        });\r\n\r\n        document.getElementById(\"sortable_list\").addEventListener(\"click\", removeListItem);\r\n    }\r\n\r\n    function render(ingredients) {\r\n        $sortableList.empty();\r\n        ingredients.forEach((ingredient) => {\r\n            $sortableList.append(produceIngredientHtml(ingredient))\r\n        });\r\n    }\r\n\r\n    function parseAndAddNewIngredient(e) {\r\n        e.preventDefault();\r\n        const newIngredient = {\r\n            title: stripHTML($titleInput.val()),\r\n            amount: stripHTML($amountInput.val()),\r\n            unit: stripHTML($unitInput.val())\r\n        };\r\n        add(newIngredient);\r\n        // reset form\r\n        inputs.forEach((input) => input.val(''));\r\n        $titleInput.focus();\r\n    }\r\n\r\n    function registerEventListeners() {\r\n        $submitButton.click(parseAndAddNewIngredient);\r\n        $undo.click(e => history.undo(e));\r\n        $redo.click(e => history.redo(e));\r\n\r\n        // Enter key pressed while cursor in one of the add-new-ingredient fields.\r\n        $(\"#add-new-ingredient-title, #add-new-ingredient-amount, #add-new-ingredient-unit\").on('keyup', function (e) {\r\n            if (e.keyCode === 13) {\r\n                parseAndAddNewIngredient(e);\r\n            }\r\n        });\r\n\r\n        wp.data.subscribe(function () {\r\n            const isSaving = wp.data.select('core/editor').isSavingPost();\r\n            const isAutoSaving = wp.data.select('core/editor').isAutosavingPost();\r\n\r\n            if (isSaving && !isAutoSaving) {\r\n                $saveNotice.toggle(false);\r\n            }\r\n        });\r\n    }\r\n\r\n    function produceIngredientHtml(ingredient) {\r\n        return `\r\n        <li class=\"cbtb-ingredients-table\">\r\n            <span class=\"cbtb-ingredient-title\">${ingredient.title ? stripHTML(ingredient.title) : ''}</span>\r\n            <span class=\"cbtb-ingredient-amount\">${ingredient.amount ? ingredient.amount : ''}</span>\r\n            <span class=\"cbtb-ingredient-unit\">${ingredient.unit ? ingredient.unit : ''}</span>\r\n            <div class=\"cbtb-remove-button\"><span class=\"dashicons dashicons-dismiss\"></span></div>\r\n        </li>`\r\n    }\r\n\r\n    function parseAndStore() {\r\n        const parsedList = parseListDOM();\r\n        store(parsedList);\r\n        return parsedList;\r\n    }\r\n\r\n    function saveState() {\r\n        const parsedList = parseAndStore();\r\n        history.push(parsedList);\r\n    }\r\n\r\n    function parseListDOM() {\r\n        let rawList = document.getElementById(\"sortable_list\");\r\n        return Array\r\n            .from(rawList.childNodes)\r\n            .filter(node => node.nodeType !== Node.TEXT_NODE)\r\n            .map(item => parseItem(item));\r\n    }\r\n\r\n    function parseItem(item) {\r\n        // parse ingredient items parts (aka. the current ingredient items DOM-subtree)\r\n        return Array\r\n            .from(item.childNodes)\r\n            .filter(node => node.nodeType !== Node.TEXT_NODE && node.nodeName.toLowerCase() === 'span')\r\n            .map(part => parsePart(part))\r\n            .reduce((parsedItemAccumulator, part) => {\r\n                if (part) {\r\n                    parsedItemAccumulator[part.identifier] = part.text;\r\n                    return parsedItemAccumulator;\r\n                }\r\n            }, {});\r\n    }\r\n\r\n    function parsePart(part) {\r\n        if (!part.classList || part.classList.length !== 1) {\r\n            throw `An ingredients components (${identifiers}) couldn't be parsed. Identifying class missing.`;\r\n        }\r\n        const identifierClassParts = part.classList[0].split('-');\r\n        if (identifierClassParts.length !== 3 || !part.classList[0].startsWith('cbtb-ingredient-')) {\r\n            throw `An ingredients components (${identifiers}) couldn't be parsed. Identifying class invalid.`;\r\n        }\r\n        const identifier = part.classList[0].split('-')[2];\r\n        if (identifiers.includes(identifier)) {\r\n            return {identifier: identifier, text: part.innerText};\r\n        }\r\n        return null;\r\n    }\r\n\r\n    function store(parsedList) {\r\n        const jsonList = JSON.stringify(parsedList);\r\n        if(loggingEnabled) {\r\n            console.log(\"Storing: \", jsonList);\r\n            console.table(parsedList);\r\n        }\r\n        $jsonStore.val(jsonList);\r\n        save(jsonList);\r\n        return jsonList;\r\n    }\r\n\r\n    function save(jsonList) {\r\n        $saveNotice.toggle(true);\r\n        const postId = wp.data.select(\"core/editor\").getCurrentPostId();\r\n        fetch(`${apiRoot}cbtb-recipe/v1/recipe/${postId}/ingredients`, {\r\n                method: 'PUT',\r\n                body: jsonList,\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    'X-WP-Nonce': nonce\r\n                }\r\n        }).then(response => {\r\n            if(loggingEnabled) console.log(response);\r\n            $saveNotice.toggle(false);\r\n        });\r\n    }\r\n\r\n    function add(ingredient) {\r\n        $sortableList\r\n            .append(produceIngredientHtml(ingredient))\r\n            .sortable(\"refresh\");\r\n\r\n        saveState();\r\n    }\r\n\r\n    function removeListItem(e) {\r\n        // ignore clicks on container\r\n        if ((e.target.nodeName.toLowerCase() === 'div' && e.target.classList.contains('cbtb-remove-button'))\r\n            || e.target.nodeName.toLowerCase() === 'span' && e.target.classList.contains('dashicons-dismiss')) {\r\n            e.target.closest('li').remove();\r\n            saveState();\r\n        }\r\n    }\r\n\r\n    function removeBeingSortedStyles(event, ui) {\r\n        ui.item.removeClass(\"cbtb-dragged\");\r\n    }\r\n\r\n    function styleItemBeingSorted(event, ui) {\r\n        ui.item.addClass(\"cbtb-dragged\");\r\n    }\r\n\r\n    function stripHTML(text) {\r\n        const doc = new DOMParser().parseFromString(text, 'text/html');\r\n        return doc.body.textContent || \"\";\r\n    }\r\n});"]}